data "azurerm_virtual_machine" "destination_virtual_machine" {
  provider            = azurerm.vm_sub
  for_each            = var.security_center_server_vulnerability_assessment_virtual_machine_variables
  name                = each.value.destination_virtual_machine_name
  resource_group_name = each.value.destination_virtual_machine_resource_group_name
}
resource "azurerm_security_center_server_vulnerability_assessment_virtual_machine" "security_center_server_vulnerability_assessment_virtual_machine" {
  provider           = azurerm.security_center_sub
  for_each           = var.security_center_server_vulnerability_assessment_virtual_machine_variables
  virtual_machine_id = data.azurerm_virtual_machine.destination_virtual_machine[each.key].id
  depends_on = [
    data.azurerm_virtual_machine.destination_virtual_machine
  ]
}
